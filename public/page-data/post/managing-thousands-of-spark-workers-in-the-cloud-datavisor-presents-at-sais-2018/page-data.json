{"componentChunkName":"component---src-templates-blog-post-template-js","path":"/post/managing-thousands-of-spark-workers-in-the-cloud-datavisor-presents-at-sais-2018","result":{"data":{"wordpressPost":{"id":"6f07714b-6a6c-5e31-a570-4e7592c04fec","title":"Managing Thousands of Spark Workers in the Cloud: DataVisor Presents at SAIS 2018","content":"<p><img src=\"https://localhost:8000/wp-content/uploads/2018/06/SAIS-2018-Logo.jpg\" sizes=\"(max-width: 301px) 100vw, 301px\" srcset=\"https://localhost:8000/wp-content/uploads/2018/06/SAIS-2018-Logo-66x66.jpg 66w, https://localhost:8000/wp-content/uploads/2018/06/SAIS-2018-Logo-150x150.jpg 150w, https://localhost:8000/wp-content/uploads/2018/06/SAIS-2018-Logo-200x199.jpg 200w, https://localhost:8000/wp-content/uploads/2018/06/SAIS-2018-Logo-300x299.jpg 300w, https://localhost:8000/wp-content/uploads/2018/06/SAIS-2018-Logo.jpg 301w\" alt=\"\" width=\"301\" height=\"300\"></p>\n<p>DataVisor’s Yuhao Zheng, Tech Lead Manager, and Boduo Li, Senior Research Scientist, Infrastructure, discuss how DataVisor leverages Spark’s scalability and portability to protect 4 Billion accounts from fraud abuse and money laundering. Watch the video to learn about managing 2000+ Spark workers in clusters and as well as DataVisor’s proprietary SparkGenerator, and automated Spark management platform that optimally balances cost and resource allocation.</p>\n<p><iframe src=\"https://player.vimeo.com/video/274692222?app_id=122963\" width=\"500\" height=\"281\" frameborder=\"0\" title=\"Managing Thousands of Spark Workers in Cloud EnvironmentYuhao Zheng (DataVisor, Inc.)Boduo Li (DataVisor, Inc.)\" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></p>\n<p><a href=\"https://databricks.com/session/managing-thousands-of-spark-workers-in-cloud-environment\">Click here to get more information about the session &gt;&gt;</a></p>\n<p>Session Abstract:</p>\n<p><em>At DataVisor, we fight online fraud, abuse, and money laundering using unsupervised machine learning approach that clusters millions of users. In order to support the computationally intensive workload, DataVisor uses Spark as the mainstay of its computation infrastructure. The scalability and portability of our Spark infrastructure is critical to our company when we expand our business. In this talk, we will present our story of how we manage our Spark infrastructure at scale.</em></p>\n<p><em>At peak time, we have 2000+ Spark workers online, and we group these workers into ~50 clusters of various size. The benefits of this, on one hand, is data isolation, which is critical to DataVisor as we are processing multi-customer data. On the other hand, this is for cost and performance consideration, as we want to provide just enough resources to each Spark application. When under-provision, Spark application will fail due to out-of-memory or out-of-disk. However we want to avoid unnecessary over-provision as it dramatically increases our cloud cost.</em></p>\n<p><em>Next, we will present our DataVisor SparkGenerator (DSG), which is designed to automatically manage our Spark infrastructure. The responsibility of DSG includes (a) launching and shutting down Spark cluster, to maximize concurrency and minimize cost, (b) assigning Spark applications to the proper clusters intelligently, according to the Spark application profile, and (c) managing the dependency among Spark applications, to make our pipeline run smoothly and efficiently, and (d) running all of the Spark worker on Spot instances, reducing the cloud computation cost versus on-demand by over 80%.</em></p>\n","excerpt":"<p>DataVisor&#8217;s Yuhao Zheng and Boduo Li share advanced techniques for managing thousands of spark workers to analyze billions of events at a time, including clustering workers and automated, optimized management of DataVisor&#8217;s spark infrastructure.</p>\n","date":"June 18, 2018","author":{"id":"aa6490dd-e59b-544b-bbe8-e20de40234f7","name":"Claire Zhou"}}},"pageContext":{"id":14146}}}